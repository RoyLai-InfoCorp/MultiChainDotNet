version: '3.4'

services:

  mc-listener:
      image: mc-listener:2.1.2
      build:
          context: ../../
          dockerfile: src/MultiChainDotNet.Listener.Service/Dockerfile
      container_name: mc-listener
      environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ASPNETCORE_URLS=http://+:12040
      ports:
      - '12040:12040'
      depends_on:
      - mc-seednode

  mc-seednode:
      image: mc-seednode:2.1.2
      build:
        context: .
        dockerfile: Dockerfile.mc-seednode
      container_name: mc-seednode
      environment:
      #- ReceivingHost=http://host.docker.internal:12040/RawTransactions
      - ReceivingHost=http://mc-listener:12040/RawTransactions
      ports:
      - '12020:12020'
      - '12021:12021'

  mc-relayer1:
      image: mc-relaynode:2.1.2
      build:
        context: .
        dockerfile: Dockerfile.mc-relaynode
      container_name: mc-relayer1
      ports:
      - '12022:12020'
      - '12023:12021'
      environment:
      - seed_ip=mc-seednode
      - rpcpassword=C6n97oxTJrEqmwvVrWGP5TgHpyewRjz2x3soDQKLFkWq
      - ptekey=VAHJarN329oHzL5fJjEJMSWoMLXdtfBXyu62D74JaKXtt77Ypc9PNaFz
      depends_on:
      - mc-seednode

  mc-relayer2:
      image: mc-relaynode:2.1.2
      build:
        context: .
        dockerfile: Dockerfile.mc-relaynode
      container_name: mc-relayer2
      ports:
      - '12024:12020'
      - '12025:12021'
      environment:
      - seed_ip=mc-seednode
      - rpcpassword=C6n97oxTJrEqmwvVrWGP5TgHpyewRjz2x3soDQKLFkWq
      - ptekey=V8Ktev3iY49EuEeUyaSaiQ1QU3gmW3M5HV8HNdx7srkR3PSty4KbpXZ4
      depends_on:
      - mc-seednode

  mc-relayer3:
    image: mc-relaynode:2.1.2
    build:
      context: .
      dockerfile: Dockerfile.mc-relaynode
    container_name: mc-relayer3
    ports:
    - '12026:12020'
    - '12027:12021'
    environment:
    - seed_ip=mc-seednode
    - rpcpassword=C6n97oxTJrEqmwvVrWGP5TgHpyewRjz2x3soDQKLFkWq
    - ptekey=V8btCNTAyxH1R9NGHF6PSWR8CTzadPHxpKTp75enouS2GHEyqxAZHVrU
    depends_on:
      - mc-seednode
    